!function(){"use strict";function e(e,t){return Math.log(t)/Math.log(e)}function t(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=r(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var u,i=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){l=!0,u=e},f:function(){try{i||null==n.return||n.return()}finally{if(l)throw u}}}}function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o=[],u=!0,i=!1;try{for(n=n.call(e);!(u=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);u=!0);}catch(e){i=!0,a=e}finally{try{u||null==n.return||n.return()}finally{if(i)throw a}}return o}}(e,t)||r(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=function(){function r(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this.elementsIds=e}var a,u;return a=r,(u=[{key:"init",value:function(){var e=this;this.numberFormat=new Intl.NumberFormat("ru-RU"),this.values={},this.findElements(),this.container.addEventListener("input",(function(t){return e.update(t)})),this.calculate()}},{key:"update",value:function(e){this.updateInput(e.target),this.calculate()}},{key:"updateInput",value:function(e){var t=this.cleanNumber(e.value),n=this.formatNumber(t);"range"!==e.type?(e.value=n,e.nextElementSibling.value=t.replace(/\.$/,"")):e.previousElementSibling.value=n}},{key:"formatNumber",value:function(e){if(e.includes(".")){var t=n(e.split("."),2),r=t[0],a=t[1];return"".concat(this.numberFormat.format(r),",").concat(a)}return this.numberFormat.format(e)}},{key:"findElements",value:function(){this.container=document.getElementById(this.elementsIds.container),this.findGroupOfElements("inputs"),this.findGroupOfElements("outputs")}},{key:"findGroupOfElements",value:function(e){this[e]=new Map;for(var t=0,r=Object.entries(this.elementsIds[e]);t<r.length;t++){var a=n(r[t],2),o=a[0],u=a[1];this[e].set(o,document.getElementById(u))}}},{key:"calculate",value:function(){this.getValues();var t=function(t,n,r,a){var o=function(e,t){return e-t}(t,n);if(o<=0)return{totalPayment:0,overpaymentMortrage:0,mortrageYears:0,monthlyPayment:0};var u=function(t,n,r){var a=(t||.01)/100/12;return e(1+a,r/(r-n*a))}(a,o,r),i=function(e,t){return e*t}(r,u);return{totalPayment:i,overpaymentMortrage:function(e,t){return e-t}(i,o),mortrageYears:function(e){return e/12}(u),monthlyPayment:r}}(this.values.propertyValue,this.values.downPayment,this.values.freeMoney,this.values.mortrageInterest),n=function(t,n,r,a,o){if(n<a)return{rentYears:0,overpaymentRent:0,monthlySavings:0};if(r<o)return{rentYears:-1,overpaymentRent:-1,monthlySavings:0};var u=function(e,t){return e-t}(r,o),i=function(t,n,r,a){var o,u=(t||.01)/100;return e(1+u/12,(o=(n-a)/(r*(12/u)+a)+1,Math.pow(o,1/12)))}(t,n,u,a);return{rentYears:i,overpaymentRent:function(e,t){return e*t*12}(o,i),monthlySavings:u}}(this.values.depositInterest,this.values.propertyValue,this.values.freeMoney,this.values.downPayment,this.values.rentValue);this.render(Object.assign(t,n))}},{key:"render",value:function(e){var r,a=t(this.outputs);try{for(a.s();!(r=a.n()).done;){var o=n(r.value,2),u=o[0];o[1].innerHTML=this.formatResult(e[u])}}catch(e){a.e(e)}finally{a.f()}}},{key:"getValues",value:function(){var e,r=t(this.inputs);try{for(r.s();!(e=r.n()).done;){var a=n(e.value,2),o=a[0],u=a[1];this.values[o]=+this.cleanNumber(u.value)}}catch(e){r.e(e)}finally{r.f()}}},{key:"formatResult",value:function(e){return e<0||Number.isNaN(e)?"âˆž":this.numberFormat.format(Math.round(e))}},{key:"cleanNumber",value:function(e){return e.replace(",",".").replace(/[^\d.]/g,"")}}])&&o(a.prototype,u),r}();document.addEventListener("DOMContentLoaded",(function(){new u({container:"container",inputs:{downPayment:"down-payment",propertyValue:"property-value",mortrageInterest:"mortrage-interest",rentValue:"rent-value",depositInterest:"deposit-interest",freeMoney:"free-money"},outputs:{mortrageYears:"mortrage-years",overpaymentMortrage:"overpayment-mortrage",rentYears:"rent-years",overpaymentRent:"overpayment-rent",monthlySavings:"monthly-savings",monthlyPayment:"monthly-payment"}}).init()}))}();